<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
      xmlns:adm="http://www.flexive.com/jsf/admin"
      xmlns:fx="http://www.flexive.com/jsf/core">
<body>

<ui:composition template="/adm/contentTemplate.xhtml">

    <ui:define name="head">
        <t:stylesheet path="/adm/css/content.css"/>
    </ui:define>

    <ui:define name="body">
        <h:form id="frm" enctype="multipart/form-data">
            <adm:tab label="#{fxMessageBean['SelectList.tab.editSelectList,#{selectListBean.selectListName}']}" active="true" id="tab1"/>

            <div style="float:right">
                <fx:fxValueInputLanguageSelect id="updateLanguages"/>
            </div>
            
            <fx:formRow labelKey="SelectList.label.selectList.name" id="name">
                <h:inputText id="name" value="#{selectListBean.selectListName}" disabled="#{not fxSystemBean.isInRole['SelectListEditor']}"/>
            </fx:formRow>
             <fx:formRow labelKey="SelectList.label.selectList.label" id="label">
                <fx:fxValueInput id="label" value="#{selectListBean.selectListLabel}" readOnly="#{not fxSystemBean.isInRole['SelectListEditor']}"/>
			</fx:formRow>
            <fx:formRow labelKey="SelectList.label.selectList.description" id="description">
                <fx:fxValueInput id="description" value="#{selectListBean.selectListDescription}" readOnly="#{not fxSystemBean.isInRole['SelectListEditor']}"/>
			</fx:formRow>
            <fx:formRow labelKey="SelectList.label.selectList.allowDynamicCreation" id="allowDynamicCreation">
                <h:selectBooleanCheckbox id="allowDynamicCreation" value="#{selectListBean.selectListAllowDynamicCreation}" disabled="true"/>
            </fx:formRow>
            <fx:formRow labelKey="SelectList.label.selectList.createItemACL" id="createItemACL">
                <t:selectOneListbox size="1" id="createItemACL" value="#{selectListBean.selectListCreateItemACLId}" disabled="true">
                    <f:selectItems value="#{fxSelectBean.selectListACLs}" />
                </t:selectOneListbox>
            </fx:formRow>
            <fx:formRow labelKey="SelectList.label.selectList.defaultItemACL" id="defaultItemACL">
                <t:selectOneListbox size="1" id="defaultItemACL" value="#{selectListBean.selectListDefaultItemACL}"
                                    onchange="submit();" converter="SelectableConverter" disabled="true">
                    <f:selectItems value="#{selectListBean.selectListItemACLs}" />
                </t:selectOneListbox>
            </fx:formRow>

            <adm:sortableTable id="table">
                <table id="table">
                    <thead>
                        <tr>
                            <th class="tblHeader" dataType="String" field="name" align="left">
                                #{fxMessageBean["SelectList.table.name"]}
                            </th>
                            <th class="tblHeader" dataType="String" field="label" align="left">
                                #{fxMessageBean["SelectList.table.label"]}
                            </th>
                            <th class="tblHeader" dataType="String" field="data" align="left">
                                #{fxMessageBean["SelectList.table.data"]}
                            </th>
                            <th class="tblHeader" dataType="html" field="acl" align="left" noSort="true">
                                #{fxMessageBean["SelectList.table.acl"]}
                            </th>
                            <th class="tblHeader" dataType="String" field="color" align="left">
                                #{fxMessageBean["SelectList.table.color"]}
                            </th>
                            <th class="tblHeader" dataType="html" field="actions" align="left" noSort="true">
                                #{fxMessageBean["SelectList.table.actions"]}
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <c:forEach var="item" items="#{selectListBean.items}">
                            <tr value="#{selectListBean.idMap[item.id]}">
                                <td align="left"><h:inputText id="itemName_#{selectListBean.idMap[item.id]}" value="#{item.name}"
                                        disabled="#{not (fxSystemBean.isInRole['SelectListEditor'] or selectListBean.mayEditItem[item])}"/></td>
                                <td align="left"><fx:fxValueInput id="itemLabel_#{selectListBean.idMap[item.id]}" value="#{item.label}" readOnly="#{not (fxSystemBean.isInRole['SelectListEditor'] or selectListBean.mayEditItem[item])}"/></td>
                                <td align="left"><h:inputText id="itemData_#{selectListBean.idMap[item.id]}" value="#{item.data}" disabled="#{not (fxSystemBean.isInRole['SelectListEditor'] or selectListBean.mayEditItem[item])}"/></td>
                                <td align="left">
                                    <t:selectOneListbox size="1" id="itemACL_#{selectListBean.idMap[item.id]}" value="#{item.acl}" converter="SelectableConverter"  disabled="#{not (fxSystemBean.isInRole['SelectListEditor'] or selectListBean.mayEditItem[item])}">
                                        <f:selectItems value="#{selectListBean.selectListItemACLs}"/>
                                    </t:selectOneListbox>
                                </td>
                                <td align="left" nowrap="nowrap">
                                    <h:inputText size="7" id="itemColor_#{selectListBean.idMap[item.id]}" value="#{item.color}"
                                        disabled="#{not (fxSystemBean.isInRole['SelectListEditor'] or selectListBean.mayEditItem[item])}"/>
                                </td>
                                <td align="left">
                                    <c:if test="#{selectListBean.mayDeleteItems}">
                                        <adm:commandButton labelKey="SelectList.button.delete" location="content"
                                                        icon="delete"  bean="#{selectListBean}" action="deleteListItem" id="deleteButton_#{selectListBean.idMap[item.id]}">
                                            <f:setPropertyActionListener target="#{selectListBean.listItemId}" value="#{item.id}"/>
                                        </adm:commandButton>
                                    </c:if>
                                </td>
                            </tr>
                        </c:forEach>
                        <c:if test="#{selectListBean.mayCreateItems[selectListBean.selectListId]}">
                            <tr>
                                <td align="left"><h:inputText id="newItemName" value="#{selectListBean.itemName}"/> </td>
                                <td align="left"><fx:fxValueInput id="newItemLabel" value="#{selectListBean.itemLabel}"/></td>
                                <td align="left"><h:inputText id="newItemData" value="#{selectListBean.itemData}"/></td>
                                <td align="left">
                                    <t:selectOneListbox size="1" id="newItemACL" value="#{selectListBean.itemACL}"
                                                        converter="SelectableConverter">
                                        <f:selectItems value="#{selectListBean.selectListItemACLs}" />
                                    </t:selectOneListbox>
                                </td>
                                <td align="left">
                                    <h:inputText size="7" id="newItemColor" value="#{selectListBean.itemColor}">
                                        <fx:colorPicker/>
                                    </h:inputText>
                                </td>
                                <td align="left">
                                    <adm:commandButton labelKey="SelectList.button.add" location="content"
                                                    icon="new"  bean="#{selectListBean}" action="addListItem" id="addButton">
                                    </adm:commandButton>
                                </td>
                            </tr>
                        </c:if>
                    </tbody>
                </table>
            </adm:sortableTable>

            <adm:commandButton labelKey="SelectList.button.selectList.save" location="both"
                icon="save"  action="saveSelectList"  bean="#{selectListBean}" id="saveButton">
            </adm:commandButton>
            
            <adm:commandButton labelKey="SelectList.button.cancel" location="both"
                icon="cancel"  action="showSelectListOverview"  bean="#{selectListBean}" id="cancelButton">
            </adm:commandButton>
            <adm:toolbarPluginButtons/>
        </h:form>

    </ui:define>
</ui:composition>
</body>
</html>