<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
      xmlns:adm="http://www.flexive.com/jsf/admin"
      xmlns:fx="http://www.flexive.com/jsf/core"
      xmlns:weblet="http://weblets.dev.java.net/tags_jsp2">
<body>

<ui:composition template="/adm/contentTemplate.xhtml">
    <ui:define name="head">
        <script type="text/javascript" src="#{fxSystemBean.contextPath}/pub/js/flexiveRpc.js"> </script>
        <script type="text/javascript" src="#{fxSystemBean.contextPath}/pub/js/jsonrpc.js"> </script>
        <script type="text/javascript" src="#{fxSystemBean.contextPath}/pub/js/selection.js"> </script>
        <script type="text/javascript" src="#{weblet:url('com.flexive.faces.weblets','/js/lytebox.js')}"/>
    </ui:define>

    <ui:define name="body">
        <c:if test="#{empty fxSearchResultBean.parseRequestParameters}"> </c:if>
        <a4j:form id="frm">
            <h:inputHidden value="#{fxSearchResultBean.viewType}"/>

            <adm:resultTabs activeTab="results"/>

            <adm:commandButton id="listButton" labelKey="SearchResult.button.view.list" bean="#{fxSearchResultBean}" action="listView" icon="view_list" location="toolbar"/>
            <adm:commandButton id="thumbsButton" labelKey="SearchResult.button.view.thumbs" bean="#{fxSearchResultBean}" action="thumbView" icon="view_thumbs" location="toolbar"/>
            <adm:commandButton id="preferencesButton" location="toolbar" labelKey="ResultPreferences.button.open" bean="#{resultPreferencesBean}" action="show" icon="configure"/>

            <c:if test="#{fxSearchResultBean.queryBuilder != null}">
                <h:inputHidden id="rowCount" value="#{fxSearchResultBean.rowCount}"/>
                <h:inputHidden id="versionFilter" value="#{fxSearchResultBean.versionFilter}"/>

                <h:selectOneListbox id="typeId" value="#{fxSearchResultBean.typeId}" size="1">
                    <f:selectItems value="#{fxSearchResultBean.contentTypeItems}"/>
                    <a4j:support event="onchange" reRender="refreshResults"/>
                </h:selectOneListbox>
                <h:selectOneListbox id="version" value="#{fxSearchResultBean.versionFilter}" size="1">
                    <f:selectItems value="#{fxSearchResultBean.versionItems}"/>
                    <a4j:support event="onchange" reRender="refreshResults"/>
                </h:selectOneListbox>

                <a4j:outputPanel id="refreshResults">
                    <fx:resultTableUpdater var="resultTable" value="#{fxSearchResultBean.result}"/>
                </a4j:outputPanel>


                <fx:resultTable var="resultTable" value="#{fxSearchResultBean.result}"/>
                
            </c:if>
            <adm:toolbarPluginButtons/>

        </a4j:form>

        <script type="text/javascript">
            if (parent.reloadBriefcases) {
                parent.reloadBriefcases();
            }
        </script>
    </ui:define>

</ui:composition>

</body>
</html>
