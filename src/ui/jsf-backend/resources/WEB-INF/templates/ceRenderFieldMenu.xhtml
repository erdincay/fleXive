<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
      xmlns:fx="http://www.flexive.com/jsf/core"
      xmlns:adm="http://www.flexive.com/jsf/admin"
      xmlns:t="http://myfaces.apache.org/tomahawk">

<ui:composition>

<c:if test="#{srcEditor.readOnly==false}">

    <c:set var="selectListId" value="addElementsListBox#{srcEditor.idGenerator[element]}" />
    <!--c:if test="#{group.property==false}">
        <c:set var="upDownStyle" value="border:0;margin-left:0px;" />
    </c:if-->
    <c:if test="#{group.property==true || group.group==true}">
        <c:set var="upDownStyle" value="border:0;float:left;margin-left:0px;" />
    </c:if>
    <c:set var="assignmentLabel" value="#{fxMapBean.assignments[group.assignmentId].label}" />


    <t:graphicImage styleClass="icon" alt="#{group.property ? fxMessageBean['Content.button.insert.property.title'] :
                                             group.XPathFull ne '/' ? fxMessageBean['Content.button.insert.group.title'] :
                                             fxMessageBean['Content.button.insert.root.title']}"
                    title="#{group.property ? fxMessageBean['Content.button.insert.property.title'] :
                                             group.XPathFull ne '/' ? fxMessageBean['Content.button.insert.group.title'] :
                                             fxMessageBean['Content.button.insert.root.title']}"
                    url="/adm/images/contentEditor/#{icon}.png"
                    onclick="showMenu(event,this,'#{group.XPathFull}')"  />

   <c:if test="#{element.XPath!=null}">
        <a4j:commandLink reRender="all" actionListener="#{srcEditor.moveElementUp}" eventsQueue="ceQueue"
                         onmouseover='ignoreEvent(event)'  onclick="if (!preA4jAction('#{group.XPathFull}','moveElementUp')) return false;">
            <f:setPropertyActionListener target="#{srcEditor.element}" value="#{group}"/>
            <t:graphicImage alt="#{fxMessageBean['Content.button.up.title']}" title="#{fxMessageBean['Content.button.up.title']}" url="/adm/images/contentEditor/up.png" style="#{upDownStyle};margin-left:3px"/>
        </a4j:commandLink>

        <a4j:commandLink reRender="all" actionListener="#{srcEditor.moveElementDown}" eventsQueue="ceQueue"
                         onmouseover='ignoreEvent(event)'  onclick="if (!preA4jAction('#{group.XPathFull}','moveElementDown')) return false;">
            <f:setPropertyActionListener target="#{srcEditor.element}" value="#{group}"/>
            <t:graphicImage alt="#{fxMessageBean['Content.button.down.title']}" title="#{fxMessageBean['Content.button.down.title']}" url="/adm/images/contentEditor/down.png" style="#{upDownStyle}"/>
        </a4j:commandLink>
    </c:if>


    <div class="popupMenu" id="Menu_#{group.XPathFull}" onmouseover='ignoreEvent(event)' style="clear:both;">
        <c:set var="count" value="0"/>
        <c:set var="items" value="#{srcEditor.addElementOptions[group]}"/>
        <c:if test="${!empty items}">
            <c:if test="${count>0}"><hr/></c:if>
            <c:set var="count" value="#{count+1}"/>
            <t:selectManyListbox styleClass="elementSelectListbox" size="4" id="#{selectListId}">
                <f:selectItems value="#{items}" />
            </t:selectManyListbox>
            <a4j:commandLink reRender="all" actionListener="#{srcEditor.addChilds}" eventsQueue="ceQueue"
                             onclick="prepareAdd('#{selectListId}');if (!preA4jAction('#{group.XPathFull}','addChilds')) return false;"
                             onmouseover='ignoreEvent(event)'>
                <f:setPropertyActionListener target="#{srcEditor.element}" value="#{group}"/>
                <br />
                <t:graphicImage styleClass="icon" alt="add" url="/adm/images/contentEditor/add.png"/>
                #{fxMessageBean['Content.field.elementmenu.addSelected']}
                <br clear="all"/>
            </a4j:commandLink>
        </c:if>

        <c:if test="${count==0}">
            #{fxMessageBean['Content.field.elementmenu.noOptions']}
        </c:if>
    </div>

    <!-- render command links to add and remove properties and groups (exclude virtual root group)-->
    <c:if test="#{group.property==true or (group.group==true and group.XPathFull ne '/')}">
        <!-- Add same element button -->
        <c:if test="#{group.createableElements>0}">
            <c:set var="count" value="#{count+1}"/>
            <a4j:commandLink reRender="all" actionListener="#{srcEditor.addElement}" eventsQueue="ceQueue"
                             onmouseover='ignoreEvent(event)'  onclick="if (!preA4jAction('#{group.XPathFull}','addProperty')) return false;">
                <f:setPropertyActionListener target="#{srcEditor.element}" value="#{group}"/>
                <t:graphicImage alt="#{fxMessageBean['Content.button.add.title']} #{assignmentLabel}"
                                title="#{fxMessageBean['Content.button.add.title']} #{assignmentLabel}" 
                                url="/adm/images/contentEditor/add.png" style="border:0;float:left;margin-left:3px;"/>
            </a4j:commandLink>
        </c:if>
        <c:if test="#{group.createableElements==0}">
            <t:graphicImage alt="#{fxMessageBean['Content.button.add.title']} #{assignmentLabel}"
                            title="#{fxMessageBean['Content.button.add.title']} #{assignmentLabel}"
                            url="/adm/images/contentEditor/add.png"
                            style="filter:alpha(opacity=25);-moz-opacity:.25;opacity:.25;float:left;margin-left:3px;"/>
        </c:if>
        <!-- Remove element button -->
        <c:if test="#{group.removeableElements>0}">
            <a4j:commandLink reRender="all" actionListener="#{srcEditor.removeElement}" eventsQueue="ceQueue"
                             onmouseover='ignoreEvent(event)' onclick="if (!preA4jAction('#{group.XPathFull}','removeProperty')) return false;">
                <f:setPropertyActionListener target="#{srcEditor.element}" value="#{group}"/>
                <t:graphicImage alt="#{fxMessageBean['Content.button.remove.title']} #{assignmentLabel}"
                                title="#{fxMessageBean['Content.button.remove.title']} #{assignmentLabel}"
                                url="/adm/images/contentEditor/remove.png" style="border:0;float:left;margin-left:3px;"/>
            </a4j:commandLink>
        </c:if>
        <c:if test="#{group.removeableElements==0}">
            <t:graphicImage alt="#{fxMessageBean['Content.button.remove.title']} #{assignmentLabel}"
                            title="#{fxMessageBean['Content.button.remove.title']} #{assignmentLabel}"
                            url="/adm/images/contentEditor/remove.png"
                            style="filter:alpha(opacity=25);-moz-opacity:.25;opacity:.25;float:left;margin-left:3px;"/>
        </c:if>
    </c:if>

</c:if>
</ui:composition>


</html>
