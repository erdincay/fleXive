<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
    xmlns:adm="http://www.flexive.com/jsf/admin"
    xmlns:fx="http://www.flexive.com/jsf/core">

Composite widget with a thumbnail table and a datascroller.

Parameters:
	id - unique ID for this component (required)
    formName - name of the embedding form (required)
    gridModel - the FxGridDataModel to be displayed (required)
    resultSet - the backing flexive result set of the grid model (required)
    dataTable - datatable binding (required)
    previewSize - preview size property (required)
    tableRows - table size in rows (not thumbnails) (required)

<ui:composition>
    <fx:menu name="#{id}_resultMenu" contextMenuTarget="frm:#{id}_resultSetTable" showHandler="function() { #{id}_MenuHandler.onShowContextMenu(); }">
        <fx:menuItem id="show" labelKey="SearchResult.menu.show" icon="open" clickHandler="function() { #{id}_MenuHandler.showRow(); }"/>
        <fx:menuItem id="edit" labelKey="SearchResult.menu.edit" icon="edit" clickHandler="function() { #{id}_MenuHandler.editRow(); }"/>
        <fx:menuSeparator/>
        <fx:menuItem id="delete" labelKey="SearchResult.menu.delete" icon="remove" clickHandler="function() { #{id}_MenuHandler.deleteRow(); }"/>
        <fx:menuItem id="deleteSelected" labelKey="SearchResult.menu.deleteSelected" icon="remove" clickHandler="function() { #{id}_MenuHandler.deleteSelectedRows(); }"/>
    </fx:menu>

    <div style="display:none">
        <h:inputHidden id="contentEditorId" value="#{contentEditorBean.id}"/>
        <h:inputHidden id="contentEditorVersion" value="#{contentEditorBean.version}"/>
        <h:commandLink id="#{id}_editButton" action="#{contentEditorBean.load}">
            <f:setPropertyActionListener value="#{false}" target="#{contentEditorBean.readOnly}"/>
        </h:commandLink>
        <h:commandLink id="#{id}_showButton" action="#{contentEditorBean.load}">
            <f:setPropertyActionListener value="#{true}" target="#{contentEditorBean.readOnly}"/>
        </h:commandLink>
    </div>
    
    <h:selectOneListbox value="#{previewSize}" size="1" onchange="document.forms['frm'].submit()">
        <f:selectItems value="#{fxSelectBean.previewSizes}"/>
    </h:selectOneListbox>

    <t:dataTable id="#{id}_resultSetTable" value="#{gridModel}" var="row" preserveDataModel="true" rows="#{tableRows}"
                 binding="#{dataTable}" rowIndexVar="tableRowIndex">
        <c:forEach var="index" begin="0" end="#{fxSearchResultBean.gridModel.columns - 1}">
            <t:column>
                <div id="row#{fxSystemBean.counter['thumbnails']}" positionId="#{row[index][0]}" rowNum="#{fxSystemBean.counterValue['thumbnails']}" colorSet="#{index % 2}" onclick="rowSelection.onRowClicked(event)" onmouseover="rowSelection.onMouseOver(event)" onmouseout="rowSelection.onMouseOut(event)">
                    <adm:resultThumbnail row="#{row[index]}" resultSet="#{resultSet}" index="#{index}"/>
                </div>
            </t:column>
        </c:forEach>
    </t:dataTable>

   <t:dataScroller for="#{id}_resultSetTable">
       <f:facet name="previous">
           <t:graphicImage url="/pub/images/jsDataScroller/previous.png" width="16" height="16" border="0"/>
       </f:facet>
       <f:facet name="next">
           <t:graphicImage url="/pub/images/jsDataScroller/next.png" width="16" height="16" border="0"/>
       </f:facet>
       <f:facet name="first">
           <t:graphicImage url="/pub/images/jsDataScroller/first.png" width="16" height="16" border="0"/>
       </f:facet>
       <f:facet name="last">
           <t:graphicImage url="/pub/images/jsDataScroller/last.png" width="16" height="16" border="0"/>
       </f:facet>
   </t:dataScroller>

    <script type="text/javascript">
        var colorSet1 = new Array("#FFFFFF", "#d3dcb7", "#ebf5cc", "#ebf5cc");
        var colorSets = new Array(colorSet1, colorSet1);

        var rowSelection = new RowSelectionContainer("positionId", "rowNum", colorSets);
        rowSelection.rowOffset = #{fxSearchResultBean.startRow};
        rowSelection.numRows = #{fxSearchResultBean.fetchRows};
        rowSelection.onMultiPageSelect = function() { };
        rowSelection.init();

        var #{id}_MenuHandler = new ResultThumbnailsTableHandler("frm", "#{id}", "#{id}_resultMenu", rowSelection,
                new ResultMenuHandler("#{formName}", "#{id}", "#{id}_resultMenu"));
    </script>
</ui:composition>
</html>