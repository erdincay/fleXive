<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
      xmlns:fx="http://www.flexive.com/jsf/core"
      xmlns:adm="http://www.flexive.com/jsf/admin"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xml:lang="en" lang="en">
<head>
    <title>Version Information tag</title>
</head>
<body>

Parameters:
* versionInfo ... FxContentVersionInfo instance

this template has to use ui:repeat to make the el expression available in fxMessageBean
see http://www.nabble.com/How-to-get-the-ui%3Aparam-value-in-Javabean--td12120387.html
or http://forum.java.sun.com/thread.jspa?threadID=5218131&amp;messageID=9886363
for more info

<ui:composition xmlns:rich="http://richfaces.org/rich">
    <c:if test="#{srcEditor.new}">
        <c:set var="lbl1" value="#{srcEditor.typeDisplay} #{fxMessageBean['Content.flag.new']}"/>
    </c:if>
    <c:if test="#{!srcEditor.new and versionInfo.versionCount > 1}">
        <c:set var="lbl1" value="#{srcEditor.typeDisplay} [Id: #{srcEditor.id}, version: #{srcEditor.version}] - #{versionInfo.versionCount} versions"/>
    </c:if>
    <c:if test="#{!srcEditor.new and versionInfo.versionCount == 1}">
        <c:set var="lbl1" value="#{srcEditor.typeDisplay} [Id: #{srcEditor.id}]"/>
    </c:if>

    <rich:simpleTogglePanel switchType="client" label="#{lbl1}" opened="false">
        <ui:repeat var="vi" value="#{versionInfo}">
            <ui:fragment rendered="#{versionInfo.hasLiveVersion}">
                #{fxMessageBean['Content.field.versionInfo.liveVersion,#{vi.liveVersion}']}<br/>
            </ui:fragment>

            <ui:fragment rendered="#{versionInfo.versionCount > 1}">
                #{fxMessageBean['Content.field.versionInfo.versionCount,#{vi.versionCount}']}<br/>
                #{fxMessageBean['Content.field.versionInfo.minVersion,#{vi.minVersion}']}<br/>
                #{fxMessageBean['Content.field.versionInfo.maxVersion,#{vi.maxVersion}']}<br/>
            </ui:fragment>
            <ui:repeat var="ver" value="#{vi.versions}">
                <hr/>
                <b>#{fxMessageBean['Content.field.versionInfo.version,#{ver}']}</b>
                #{fxMessageBean['Content.field.versionInfo.step,#{fxMapBean.step[vi.versionSelector[ver].step]}']}
                <br/>
                <ui:fragment rendered="#{ver!=srcEditor.version and srcEditor.readOnly}">
                    <adm:commandIcon labelKey="Content.button.loadVersion" location="content"
                                     icon="load" action="reload" bean="#{srcEditor}"
                                     id="loadVersion_#{ver}">
                        <f:setPropertyActionListener target="#{srcEditor.version}" value="#{ver}"/>
                    </adm:commandIcon>
                    <ui:fragment rendered="#{srcEditor.versionDeleteAble}">
                        <adm:commandIcon labelKey="Content.button.deleteVersion" location="content"
                                         icon="delete" action="deleteVersion" bean="#{srcEditor}"
                                         id="removeVersion_#{ver}">
                            <f:setPropertyActionListener target="#{srcEditor.version}" value="#{ver}"/>
                        </adm:commandIcon>
                    </ui:fragment>
                    <br/>
                </ui:fragment>
                #{fxMessageBean['Content.field.versionInfo.created,#{fxMapBean.dateTime[vi.versionSelector[ver].lifeCycleInfo.creationTime]},#{fxMapBean.account[vi.versionSelector[ver].lifeCycleInfo.creatorId].name}']}<br/>
                #{fxMessageBean['Content.field.versionInfo.modified,#{fxMapBean.dateTime[vi.versionSelector[ver].lifeCycleInfo.modificationTime]},#{fxMapBean.account[vi.versionSelector[ver].lifeCycleInfo.modificatorId].name}']}<br/>
            </ui:repeat>
        </ui:repeat>
    </rich:simpleTogglePanel>
</ui:composition>



</body>
</html>